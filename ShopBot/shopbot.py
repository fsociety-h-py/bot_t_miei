# @@@@@@@@  @@@@@@  @@@@@@   @@@@@@@ @@@ @@@@@@@@ @@@@@@@ @@@ @@@
# @@!      !@@     @@!  @@@ !@@      @@! @@!        @@!   @@! !@@
# @!!!:!    !@@!!  @!@  !@! !@!      !!@ @!!!:!     @!!    !@!@! 
# !!:          !:! !!:  !!! :!!      !!: !!:        !!:     !!:  
#  :       ::.: :   : :. :   :: :: : :   : :: :::    :      .:   

#--------------- LIBRERIE ---------------#

import os
import datetime
import random
import sys
import shutil

from datetime import datetime
from telethon.sync import TelegramClient
from telethon import TelegramClient,events,sync,Button
from telethon import functions,types

#----------------------------------------#



#--------------- NOME SESSION, API ID, API HASH, START CLIENT ---------------#

bot = input("Inserisci un nome da applicare al file .session, se esiste hai gi√† un file inserisci il nome del file gi√† esistente (ESCLUSA l'estensione finale del file): ")
api_id = 11433512
api_hash = "608c12a75871c85cec3da8facbfb11cf"
client = TelegramClient(bot,api_id,api_hash)
client.start()

#----------------------------------------------------------------------------#



########## VARIABILI, TI VERRANNO RICHIESTE OGNI VOLTA ALL'AVVIO DEL FILE ##########

admin_id = int(input("Inserisci l'ID Telegram del proprietario del BOT che potr√† utilizzare TUTTE le opzioni amministrative: "))
bot_name = input("Inserisci il nome dello SHOP BOT: ")
nome_operatore = input("Inserisci il nome operatore, ovvero il nome che comparir√† agli utenti nelle comunicazioni via chat-live: ")
obbligo_canale = input('Vuoi obbligare gli utenti a iscriversi a un tuo canale prima di utilizzare il BOT? (S/N) ')
if obbligo_canale == "S" or obbligo_canale == "s":
    obbligo = True
    canale_obbligo = input("Inserisci l'username del tuo canale Telegram (inclusa la @): ")
    
elif obbligo_canale == "N" or obbligo_canale == "n":
    obbligo = False

############################################


#----------------------------------------------------------------


########## VARIABILE DATA & ORA ##########

now = datetime.now()
dataora = now.strftime("%d/%m/%Y %H:%M:%S")

##########################################


#----------------------------------------------------------------


#MESSAGGI IN ENTRATA---------------------------------------------#

@client.on(events.NewMessage)
async def my_event_handler(e):
    ########## VARIABILI (NON MODIFICABILI) ##########
    
    client.parse_mode = 'html'
    sender = await e.get_sender()
    userpath = "utenti/" + str(sender.id) + "/"
    text = e.text.split(' ')
    
    file = open("admin/lista_admin", "r", encoding='utf-8')
    lista_admin = file.read()
    file.close()
    
    file = open("admin/lista_ban", "r", encoding='utf-8')
    lista_ban = file.read()
    file.close()
    
    ##################################################
    
    
    #----------------------------------------------------------------
    
    
    ########## SEZIONE ADMIN ##########
    
    if sender.id == admin_id or lista_admin.__contains__(str(sender.id)):
        file = open("admin/stato", "r", encoding='utf-8')
        admin_stato = file.read()
        file.close()
        
        
        if admin_stato.__contains__("nome_categoria"):
            file = open("admin/stato", "r", encoding='utf-8')
            categoria_selezionata_read = file.read().splitlines()
            file.close()
            
            categoria_selezionata = categoria_selezionata_read[0]
            
            os.rename("prodotti/" + categoria_selezionata, "prodotti/" + e.text)
            
            await e.respond("‚úÖ OPERAZIONE COMPLETATA ‚úÖ",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "admin_shop")]])
            
            file = open("admin/stato", "w")
            file.truncate(0)
            file.close()
        
        
        
        
        elif admin_stato == "aggiungi_categoria":
            os.mkdir("prodotti/" + e.text)
            
            await e.respond("‚úÖ Operazione eseguita correttamente.",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "admin_shop")]])
            
            file = open("admin/stato", "w")
            file.truncate(0)
            file.close()
        
        
        
        
        elif admin_stato == "messaggio_globale":
            all_user = os.listdir("utenti/")
            all_user_count = len(all_user)
            i = -1
            
            await e.respond("üîÑ <i>Attendi mentre invio il messaggio agli utenti...</i> üîÑ")
            
            while i < all_user_count - 1:
                i = i + 1
                
                try:
                    await client.send_message(int(all_user[i]), e.text)
                
                except:
                    pass
                
            await e.respond("‚úÖ Messaggio inviato correttamente a tutti gli utenti.",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "Home_admin")]])
            
            file = open("admin/stato", "w")
            file.truncate(0)
            file.close()
        
        
        
        
        elif admin_stato.__contains__("aggiungi_prodotto"):
            file = open("admin/stato", "r", encoding='utf-8')
            categoria_selezionata_read = file.read().splitlines()
            file.close()
            
            categoria_selezionata = categoria_selezionata_read[0]
            
            os.mkdir("prodotti/" + categoria_selezionata + "/" + e.text)
            path = "prodotti/" + categoria_selezionata + "/" + e.text + "/"
            
            file = open(path + "nome", "w", encoding='utf-8')
            file.write(e.text)
            file.close()
            
            file = open(path + "accounts", "w", encoding='utf-8')
            file.write("")
            file.close()
            
            file = open(path + "descrizione", "w", encoding='utf-8')
            file.write("NESSUNA DESCRIZIONE IMPOSTATA")
            file.close()
            
            file = open(path + "prezzo", "w", encoding='utf-8')
            file.write("0.00")
            file.close()
            
            file = open(path + "tipologia", "w", encoding='utf-8')
            file.write("account")
            file.close()
            
            await e.respond("‚úÖ Operazione eseguita correttamente.",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "admin_shop")]])
            
            file = open("admin/stato", "w")
            file.truncate(0)
            file.close()
        
        
        
        
        elif admin_stato == "aggiungi_file":
            nome_file = e.text
            await e.respond("‚úÖ Ok il tuo file si chiamer√† <b>" + nome_file + "</b>. Ora invia il file da uplodare nel database del BOT.",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "gestione_file")]])
            
            file = open("admin/stato", "w")
            file.truncate(0)
            file.write(nome_file + "\naggiungi_file_upload")
            file.close()
        
        
        
        
        elif admin_stato.__contains__("aggiungi_file_upload"):
            file = open("admin/stato", "r")
            nome_file = file.read().splitlines()
            file.close()
            
            try:
                nome1 = nome_file[0].split('>')[1]
                nome2 = nome1.split('<')[0]
            except:
                nome2 = nome_file[0]
        
            if e.media:
                await e.download_media("files/" + nome2)
                
                await e.respond("‚úÖ FILE UPLODATO CON SUCCESSO ‚úÖ",
                    buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "gestione_file")]])
                
                file = open("admin/stato", "w")
                file.truncate(0)
                file.close()
            
            else:
                await e.respond("‚ùå INVIA UN FILE VALIDO ‚ùå",
                    buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "gestione_file")]])
        
        
        
        
        elif admin_stato == "rimuovi_file":
            nome_file = e.text
            
            try:
                nome1 = nome_file.split('>')[1]
                nome2 = nome1.split('<')[0]
            except:
                nome2 = nome_file
            
            try:
                os.remove("files/" + nome2)
            
                await e.respond("‚úÖ FILE RIMOSSO CORRETTAMENTE ‚úÖ",
                        buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "gestione_file")]])
                
                file = open("admin/stato", "w")
                file.truncate(0)
                file.close()
            
            except:
                await e.respond("‚ùå IL FILE SPECIFICATO NON ESISTE ‚ùå",
                    buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "gestione_file")]])
        
        
        
        
        elif admin_stato == "scarica_file":
            nome_file = e.text
            
            try:
                nome1 = nome_file.split('>')[1]
                nome2 = nome1.split('<')[0]
            except:
                nome2 = nome_file
            
            try:
                await client.send_file(admin_id, "files/" + nome2)
            
                await e.respond("‚úÖ FILE INVIATO ‚úÖ",
                    buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "gestione_file")]])
                
                file = open("admin/stato", "w")
                file.truncate(0)
                file.close()
            
            except:
                await e.respond("‚ùå Il file specifico non √® presente nel database del BOT.",
                    buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "gestione_file")]])
        
        
        
        
        elif admin_stato.__contains__("nome_prodotto"):
            file = open("admin/stato", "r", encoding='utf-8')
            stato = file.read().splitlines()
            file.close()
            
            categoria_selezionata = stato[0]
            prodotto_selezionato = stato[1]
            
            path = "prodotti/" + categoria_selezionata + "/" + prodotto_selezionato + "/"
            
            file = open(path + "nome", "w", encoding='utf-8')
            file.truncate(0)
            file.write(e.text)
            file.close()
            
            file = open("admin/stato", "w", encoding='utf-8')
            file.write(e.text)
            file.close()
            
            os.rename(path, "prodotti/" + categoria_selezionata + "/" + e.text)
            
            file = open("admin/stato", "r", encoding='utf-8')
            stato_read = file.read()
            file.close()
            
            file = open("admin/stato", "w", encoding='utf-8')
            file.truncate(0)
            file.write(categoria_selezionata + "\n" + stato_read.replace(prodotto_selezionato, e.text))
            file.close()
            
            
            await e.respond("‚úÖ NOME MODIFICATO CORRETTAMENTE ‚úÖ",
                    buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "return_prodotto_scelto")]])
        
        
        
        
        elif admin_stato.__contains__("descrizione_prodotto"):
            file = open("admin/stato", "r", encoding='utf-8')
            stato = file.read().splitlines()
            file.close()
            
            categoria_selezionata = stato[0]
            prodotto_selezionato = stato[1]
            
            path = "prodotti/" + categoria_selezionata + "/" + prodotto_selezionato + "/"
            
            file = open(path + "descrizione", "w", encoding='utf8')
            file.truncate(0)
            file.write(e.text)
            file.close()
            
            file = open("admin/stato", "r", encoding='utf-8')
            stato_read = file.read()
            file.close()
            
            file = open("admin/stato", "w", encoding='utf-8')
            file.truncate(0)
            file.write(stato_read.replace(stato[2], "").strip('\n'))
            file.close()
            
            await e.respond("‚úÖ DESCRIZIONE MODIFICATA CORRETTAMENTE ‚úÖ",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "return_prodotto_scelto")]])
        
        
        
        
        elif admin_stato.__contains__("imposta_file"):
            file = open("admin/stato", "r", encoding='utf-8')
            stato = file.read().splitlines()
            file.close()
            
            categoria_selezionata = stato[0]
            prodotto_selezionato = stato[1]
            
            path = "prodotti/" + categoria_selezionata + "/" + prodotto_selezionato + "/"
            
            testo = e.text
            
            try:
                file_selezionato_try = testo.split('>')[1]
                file_selezionato = file_selezionato_try.split('<')[0]
            except:
                file_selezionato = testo
            
            try:
                file = open("files/" + file_selezionato, "r")
                file.close()
                
                file = open(path + "tipologia", "r", encoding='utf8')
                tipologia = file.read()
                file.close()
                
                file = open(path + "tipologia", "r", encoding='utf8')
                tipologia2 = file.read().splitlines()
                file.close()
                
                try:
                    check = tipologia2[1]
                    
                    file = open(path + "tipologia", "w", encoding='utf8')
                    file.truncate(0)
                    file.write(tipologia.replace(check, file_selezionato).strip("\n"))
                    file.close()
                
                except:
                    file = open(path + "tipologia", "w", encoding='utf8')
                    file.truncate(0)
                    file.write(tipologia + "\n" + file_selezionato)
                    file.close()
                
                await e.respond("‚úÖ FILE IMPOSTATO CORRETTAMENTE ‚úÖ",
                    buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "return_prodotto_scelto")]])
                
                file = open("admin/stato", "r", encoding='utf-8')
                stato_read = file.read()
                file.close()
                
                file = open("admin/stato", "w", encoding='utf-8')
                file.truncate(0)
                file.write(stato_read.replace(stato[2], "").strip('\n'))
                file.close()
            
            except:
                await e.respond("‚ùå IL FILE SPECIFICATO NON ESISTE NEL DATABASE ‚ùå",
                    buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "return_prodotto_scelto")]])
        
        
        
        
        elif admin_stato.__contains__("pannello_account"):
            file = open("admin/stato", "r", encoding='utf-8')
            stato = file.read().splitlines()
            file.close()
            
            categoria_selezionata = stato[0]
            prodotto_selezionato = stato[1]
            
            path = "prodotti/" + categoria_selezionata + "/" + prodotto_selezionato + "/"
            
            file = open(path + "accounts", "r", encoding='utf-8')
            accounts = file.read()
            file.close()
            
            if accounts == "":
                file = open(path + "accounts", "w", encoding='utf-8')
                file.truncate(0)
                file.write(e.text)
                file.close()
            
            else:
                file = open(path + "accounts", "w", encoding='utf-8')
                file.truncate(0)
                file.write(accounts + "\n" + e.text)
                file.close()
            
            await e.respond("‚úÖ ACCOUNT/S AGGIUNTO/I ALLA LISTA ‚úÖ",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "return_prodotto_scelto")]])
            
            file = open("admin/stato", "r", encoding='utf-8')
            stato_read = file.read()
            file.close()
            
            file = open("admin/stato", "w", encoding='utf-8')
            file.truncate(0)
            file.write(stato_read.replace(stato[2], "").strip('\n'))
            file.close()
        
        
        
        
        elif admin_stato.__contains__("rimuovi_account"):
            file = open("admin/stato", "r", encoding='utf-8')
            stato = file.read().splitlines()
            file.close()
            
            categoria_selezionata = stato[0]
            prodotto_selezionato = stato[1]
            
            path = "prodotti/" + categoria_selezionata + "/" + prodotto_selezionato + "/"
            
            file = open(path + "accounts", "r", encoding='utf-8')
            accounts = file.read()
            file.close()
            
            file = open(path + "accounts", "w", encoding='utf-8')
            file.truncate(0)
            file.write(accounts.replace("\n" + e.text, "").strip("\n"))
            file.close()
            
            await e.respond("‚úÖ ACCOUNT RIMOSSO DALLA LISTA ‚úÖ",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "all_account_view")]])
            
            file = open("admin/stato", "r", encoding='utf-8')
            stato_read = file.read()
            file.close()
            
            file = open("admin/stato", "w", encoding='utf-8')
            file.truncate(0)
            file.write(stato_read.replace(stato[2], "").strip('\n'))
            file.close()
        
        
        
        
        elif admin_stato.__contains__("prezzo_prodotto"):
            file = open("admin/stato", "r", encoding='utf-8')
            stato = file.read().splitlines()
            file.close()
            
            categoria_selezionata = stato[0]
            prodotto_selezionato = stato[1]
            
            path = "prodotti/" + categoria_selezionata + "/" + prodotto_selezionato + "/"
            
            try:
                if e.text.__contains__(","):
                    prezzo = float(e.text.replace(",", "."))
                
                else:
                    prezzo = float(e.text)
                
                file = open(path + "prezzo", "w")
                file.truncate(0)
                file.write(str(format(prezzo, ".2f")))
                file.close()
                
                await e.respond("‚úÖ PREZZO AGGIORNATO CORRETTAMENTE ‚úÖ",
                    buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "return_prodotto_scelto")]])
                
                file = open("admin/stato", "r", encoding='utf-8')
                stato_read = file.read()
                file.close()
                
                file = open("admin/stato", "w", encoding='utf-8')
                file.truncate(0)
                file.write(stato_read.replace(stato[2], "").strip('\n'))
                file.close()
            
            except:
                await e.respond("‚ùå <b>ERRORE</b> ‚ùå\n\n‚ÑπÔ∏è Inserisci un prezzo valido, puoi inserire anche i centesimi.",
                    buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "return_prodotto_scelto")]])
        
        
        
        
        elif admin_stato == "get_info_user":
            try:
                id_user = int(e.text)
                path = "utenti/" + str(id_user) + "/"
                
                file = open(path + "saldo", "r", encoding='utf-8')
                saldo = file.read()
                file.close()
                
                file = open(path + "dataavvio", "r", encoding='utf-8')
                dataavvio = file.read()
                file.close()
                
                saldo_attuale = float(saldo)
                saldo_attuale_finale = str(format(saldo_attuale,".2f"))
                
                await e.respond("üë§ <b>" + str(id_user) + "</b>\n\nüí∞ Saldo disponibile: " + saldo_attuale_finale.replace(".", ",") + " EUR\nüïñ Primo avvio del BOT: " + dataavvio,
                    buttons=[[Button.inline("üïñ CRONOLOGIA ORDINI üïñ", "get_cronologia_user" + " " + str(id_user))],
                        [Button.inline("‚¨ÖÔ∏è INDIETRO", "get_info_user")]])
                
                file = open("admin/stato", "w")
                file.truncate(0)
                file.close()
            
            except:
                pass
        
        
        
        
        elif admin_stato == "add_saldo":
            try:
                id_user = int(text[0])
                
                if e.text.__contains__(","):
                    credito = float(text[1].replace(",", "."))
                
                else:
                    credito = float(text[1])
                
                path = "utenti/" + str(id_user) + "/"
                
                file = open(path + "saldo", "r", encoding='utf-8')
                saldo = file.read()
                file.close()
                
                saldo_attuale = float(saldo)
                
                calcolo = saldo_attuale + credito
                
                file = open(path + "saldo", "w", encoding='utf-8')
                file.truncate(0)
                file.write(str(format(calcolo, ".2f")))
                file.close()
                
                
                file = open(path + "cronologia", "r", encoding='utf-8')
                cronologia = file.read()
                file.close()
                
                credito_str = str(format(credito, ".2f"))
                
                file = open(path + "cronologia", "w", encoding='utf-8')
                file.truncate(0)
                file.write(cronologia + "\n\n\nüîÑ RICARICA üîÑ\nüí≥ Saldo: +" + credito_str.replace(".", ",") + " EUR\nüïë Data & ora: " + dataora)
                file.close()
                
                await e.respond("‚úÖ Saldo aggiunto correttamente (+" + credito_str.replace(".", ",") + " EUR) all'utente " + str(id_user),
                     buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "admin_utenti")]])
                
                await client.send_message(int(id_user), "üîÑ RICARICA üîÑ\n‚ÑπÔ∏è Ti informiamo che il tuo saldo √® stato ricaricato.\n\nüí≥ Saldo: +" + credito_str.replace(".", ",") + " EUR\nüïë Data & ora: " + dataora,
                    buttons=[[Button.inline("üè† Vai alla Home üè†", "Homebuy")]])
                
                file = open("admin/stato", "w")
                file.truncate(0)
                file.close()
            
            except:
                pass
        
        
        
        
        elif admin_stato == "rimuovi_saldo":
            try:
                id_user = int(text[0])
                
                if e.text.__contains__(","):
                    credito = float(text[1].replace(",", "."))
                
                else:
                    credito = float(text[1])
                
                path = "utenti/" + str(id_user) + "/"
                
                file = open(path + "saldo", "r", encoding='utf-8')
                saldo = file.read()
                file.close()
                
                saldo_attuale = float(saldo)
                
                calcolo = saldo_attuale - credito
                
                file = open(path + "saldo", "w", encoding='utf-8')
                file.truncate(0)
                file.write(str(format(calcolo, ".2f")))
                file.close()
                
                
                file = open(path + "cronologia", "r", encoding='utf-8')
                cronologia = file.read()
                file.close()
                
                credito_str = str(format(credito, ".2f"))
                
                file = open(path + "cronologia", "w", encoding='utf-8')
                file.truncate(0)
                file.write(cronologia + "\n\n\n‚ùå SALDO RIMOSSO ‚ùå\nüí≥ Saldo: -" + credito_str.replace(".", ",") + " EUR\nüïë Data & ora: " + dataora)
                file.close()
                
                await e.respond("‚úÖ Saldo rimosso correttamente (-" + credito_str.replace(".", ",") + " EUR) all'utente " + str(id_user),
                     buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "admin_utenti")]])
                
                await client.send_message(int(id_user), "‚ùå SALDO RIMOSSO ‚ùå\n‚ÑπÔ∏è Ti informiamo che il tuo saldo √® stato rimosso dall'amministratore del BOT.\n\nüí≥ Saldo: -" + credito_str.replace(".", ",") + " EUR\nüïë Data & ora: " + dataora,
                    buttons=[[Button.inline("üè† Vai alla Home üè†", "Homebuy")]])
                
                file = open("admin/stato", "w")
                file.truncate(0)
                file.close()
            
            except:
                pass
        
        
        
        
        elif admin_stato == "attiva_metodo_paypal":
            file = open("admin/pagamenti/paypal", "w", encoding='utf-8')
            file.truncate(0)
            file.write(e.text)
            file.close()
            
            file = open("admin/stato", "w")
            file.truncate(0)
            file.close()
            
            await e.respond("‚úÖ Metodo attivato e impostato correttamente.",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "metodo_paypal")]])
        
        
        
        
        elif admin_stato == "attiva_metodo_bitcoin":
            file = open("admin/pagamenti/bitcoin", "w", encoding='utf-8')
            file.truncate(0)
            file.write(e.text)
            file.close()
            
            file = open("admin/stato", "w")
            file.truncate(0)
            file.close()
            
            await e.respond("‚úÖ Metodo attivato e impostato correttamente.",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "metodo_bitcoin")]])
        
        
        
        
        elif admin_stato == "attiva_metodo_monero":
            file = open("admin/pagamenti/monero", "w", encoding='utf-8')
            file.truncate(0)
            file.write(e.text)
            file.close()
            
            file = open("admin/stato", "w")
            file.truncate(0)
            file.close()
            
            await e.respond("‚úÖ Metodo attivato e impostato correttamente.",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "metodo_monero")]])
        
        
        
        
        elif admin_stato == "add_admin":
            try:
                id_utente = int(e.text)
                
                file = open("admin/lista_admin", "r", encoding='utf-8')
                admins = file.read()
                file.close()
                
                
                if admins == "":
                    file = open("admin/lista_admin", "w", encoding='utf-8')
                    file.truncate(0)
                    file.write(str(id_utente))
                    file.close()
                
                else:
                    file = open("admin/lista_admin", "w", encoding='utf-8')
                    file.truncate(0)
                    file.write(admins + "\n" + str(id_utente))
                    file.close()
                
                
                await e.respond("‚úÖ Utente aggiunto correttamente admin.",
                    buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "lista_admin")]])
                
                file = open("admin/stato", "w")
                file.truncate(0)
                file.close()
            
            except:
                pass
        
        
        
        
        elif admin_stato == "remove_admin":
            try:
                id_utente = int(e.text)
                utente = str(id_utente)
                
                file = open("admin/lista_admin", "r", encoding='utf-8')
                admins = file.read()
                file.close()
                
                
                file = open("admin/lista_admin", "w", encoding='utf-8')
                file.truncate(0)
                file.write(admins.replace(utente, ""))
                file.close()
                
                
                with open('admin/lista_admin') as reader, open('admin/lista_admin', 'r+', encoding='utf-8') as writer:
                  for line in reader:
                    if line.strip():
                      writer.write(line)
                  writer.truncate()
                
                
                await e.respond("‚úÖ Utente rimosso correttamente dalla lista admin.",
                    buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "lista_admin")]])
                
                file = open("admin/stato", "w")
                file.truncate(0)
                file.close()
            
            except:
                pass
        
        
        
        
        elif admin_stato == "modifica_tos":
            file = open("admin/tos", "w", encoding='utf-8')
            file.truncate(0)
            file.write(str(e.text))
            file.close()
            
            await e.respond("‚úÖ TOS impostati correttamente.",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "admin_tos")]])
        
        
        
        
        elif admin_stato == "ban_user":
            try:
                file = open("admin/lista_ban", "r", encoding='utf-8')
                bannati = file.read()
                file.close()
                
                file = open("admin/lista_ban", "w", encoding='utf-8')
                file.truncate(0)
                file.write(bannati + "\n" + e.text)
                file.close()
                
                await e.respond("‚úÖ Utente bannato correttamente.",
                    buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "admin_ban")]])
                
                file = open("admin/stato", "w")
                file.truncate(0)
                file.close()
            
            except:
                pass
        
        
        
        
        elif admin_stato == "unban_user":
            try:
                file = open("admin/lista_ban", "r", encoding='utf-8')
                bannati = file.read()
                file.close()
                
                file = open("admin/lista_ban", "w", encoding='utf-8')
                file.truncate(0)
                file.write(bannati.replace(e.text, ""))
                file.close()
                
                with open('admin/lista_ban') as reader, open('admin/lista_ban', 'r+') as writer:
                  for line in reader:
                    if line.strip():
                      writer.write(line)
                  writer.truncate()
                
                await e.respond("‚úÖ Utente sbannato correttamente.",
                    buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "admin_ban")]])
                
                file = open("admin/stato", "w")
                file.truncate(0)
                file.close()
            
            except:
                pass
    
        
        
        
        elif e.text == "/start":
            await e.respond("üëÆ <b>PANNELLO ADMIN</b>üëÆ\n\nüë§ User: <b>" + sender.first_name + "</b>\nüÜî <b>" + str(sender.id) + "</b>.\n\n‚Ü™Ô∏è Naviga tra i men√π tramite le opzioni sotto-stanti per gestire l'utenza e le opzioni amministrative.",
                buttons=[[Button.inline("üëÆ ADMIN üëÆ", "lista_admin"), Button.inline("üë• UTENTI üë•", "admin_utenti")],
                    [Button.inline("‚õî BAN ‚õî", "admin_ban"), Button.inline("üõí SHOP üõí", "admin_shop")],
                    [Button.inline("üìÅ GESTIONE FILE üìÅ", "gestione_file"), Button.inline("üí¨ MESSAGGIO GLOBALE üí¨", "messaggio_globale")],
                    [Button.inline("üí≥ METODI DI PAGAMENTO üí≥", "metodi_pagamento"), Button.inline("üõ°Ô∏è TOS üõ°Ô∏è", "admin_tos")]])
        
        
        
        
        elif text[0] == "/mex":
            try:
                id_utente = text[1]
                
                messaggio1 = e.text.replace(text[0], "")
                messaggio2 = messaggio1.replace(text[1], "")
                
                messaggio = messaggio2.lstrip()
                
                await client.send_message(int(id_utente), nome_operatore + ": " + messaggio)
                
                await e.respond("‚úÖ Messaggio inviato")
                
                file = open("admin/lista_admin", "r", encoding='utf8')
                admins = file.read().splitlines()
                file.close()
                
                admins_num = len(admins)
                i = -1
                
                if sender.id == admin_id:
                    pass
                
                else:
                    await client.send_message(int(admin_id), "üëÆ L'admin " + str(sender.id) + " ha inviato un messaggio a <a href='tg://user?id= " + id_utente + "'>l'utente</a> ID " + id_utente)
                
                while i < admins_num - 1:
                    i = i + 1
                    
                    if admins[i] == str(sender.id):
                        pass
                    
                    else:
                        await client.send_message(int(admins[i]), "üëÆ L'admin " + str(sender.id) + " ha inviato un messaggio a l'utente ID " + id_utente)
            
            except:
                pass
    
    ###################################
    
    
    #----------------------------------------------------------------#
    
    
    ########## SEZIONE UTENTE ##########
    
    else:
        
        if lista_ban.__contains__(str(sender.id)):
            await e.respond("‚õî <b>SEI STATO BANNATO</b> ‚õî\n\n‚ÑπÔ∏è Spiacenti, ma uno degli amministratori del BOT ha deciso di bannarti. Non potrai utilizzare il BOT e le sue funzioni ammenoch√® non verrai riammesso dallo staff.")
        
        else:
            try:
                file = open(userpath + "verifica")
                file.close()
            
            except:
                os.mkdir(userpath)
                
                file = open(userpath + "verifica", "w")
                file.write("")
                file.close()
                
                file = open(userpath + "saldo", "w")
                file.write("0.00")
                file.close()
                
                file = open(userpath + "dataavvio", "w")
                file.write(dataora)
                file.close()
                
                file = open(userpath + "cronologia", "w")
                file.write("")
                file.close()
                
                file = open(userpath + "stato", "w")
                file.write("")
                file.close()
            
            
            
            
            ###############
            if obbligo == True:
                try:
                    result = await client(functions.channels.GetParticipantRequest(
                    channel=canale_obbligo,
                    participant=int(sender.id)
                    ))
                
                except:
                    try:
                        canale_replace = canale_obbligo.replace("@", "")
                    except:
                        canale_replace = canale_obbligo
                    
                    await e.respond("‚ö†Ô∏è <b>ATTENZIONE</b> ‚ö†Ô∏è\n\n‚ÑπÔ∏è Per poter utilizzare il BOT devi essere iscritto a " + canale_obbligo + ". Iscriviti e successivamente premi sul pulsante 'AGGIORNA' sotto-stante.",
                        buttons=[[Button.url("‚úÖISCRIVITI‚úÖ", "https://t.me/" + canale_replace.lstrip())],
                            [Button.inline("üîÑ AGGIORNA üîÑ", "check_canale")]])
                    return
            
            
            file = open(userpath + "stato", "r", encoding='utf8')
            utente_stato = file.read()
            file.close()
            
            
            
            if utente_stato == "chatlive":
                if e.text == "/annulla":
                    file = open(userpath + "stato", "w")
                    file.truncate(0)
                    file.close()
                    
                    await e.respond("‚ùå CHAT-LIVE TERMINATA ‚ùå",
                        buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "Home")]])
                
                else:
                    await client.send_message(int(admin_id), "üë§ <a href='tg://user?id=" + str(sender.id) + "'>" + sender.first_name + "</a> ID <pre>" + str(sender.id) + "</pre> TI HA INVIATO QUESTO MESSAGGIO ‚§µÔ∏è\n\n<i>Digita /mex + id utente + il tuo messaggio per rispondere alla sua richiesta.</i>")
                    
                    result = await client(functions.messages.ForwardMessagesRequest(
                    from_peer='me',
                    id=[e.id],
                    to_peer=int(admin_id),
                    with_my_score=True ))
                    
                    file = open("admin/lista_admin", "r", encoding='utf-8')
                    lista_utenti = file.read().splitlines()
                    lista_utenti_num = len(lista_utenti)
                    file.close()
                    
                    i = -1
                    
                    while i < lista_utenti_num - 1:
                        i = i + 1
                        
                        await client.send_message(int(lista_utenti[i]), "üë§ <a href='tg://user?id=" + str(sender.id) + "'>" + sender.first_name + "</a> ID <pre>" + str(sender.id) + "</pre> TI HA INVIATO QUESTO MESSAGGIO ‚§µÔ∏è\n\n<i>Digita /mex + id utente + il tuo messaggio per rispondere alla sua richiesta.</i>")
                        
                        result = await client(functions.messages.ForwardMessagesRequest(
                        from_peer='me',
                        id=[e.id],
                        to_peer=int(lista_utenti[i]),
                        with_my_score=True ))
                
                
                
                
            elif e.text == "/start":
                file = open(userpath + "dataavvio", "r")
                data_ora_avvio = file.read()
                file.close()

                file = open(userpath + "saldo", "r")
                saldo_read = file.read()
                file.close()
                
                saldo = float(saldo_read)
                
                await e.respond("<b> üëãüèª Ciao " + sender.first_name + ".\n\nü§ñ Questo √® lo shop di @fsocietyUserBot\n\nüí≥ Saldo attuale: " + str(format(saldo, ".2f")) + "‚Ç¨</b>",
                    buttons=[[Button.inline("üí∞ Saldo", "wallet"), Button.inline("Shop üõç", "shop")],
                    [Button.inline("üíé Tos", "tos"), Button.inline("Supporto ‚òé", "chatlive")]])


    ####################################
    
    
    #----------------------------------------------------------------
    
    
#CALLBACK BUTTON ---------------------------------------------#

@client.on(events.CallbackQuery())
async def CallbackQuery(e):
    ########## VARIABILI (NON MODIFICABILI) ##########
    
    client.parse_mode = 'html'
    sender = await e.get_sender()
    userpath = "utenti/" + str(sender.id) + "/"
    user_callback = int(e.original_update.user_id)
    data_str = e.data.decode('utf-8')
    data = data_str.split(' ')
    
    file = open("admin/lista_admin", "r", encoding='utf-8')
    lista_admin = file.read()
    file.close()
    
    file = open("admin/lista_ban", "r", encoding='utf-8')
    lista_ban = file.read()
    file.close()
    
    ##################################################
    
    
    #----------------------------------------------------------------
    
    
    ########## SEZIONE ADMIN ##########
    
    if user_callback == admin_id or lista_admin.__contains__(str(user_callback)):
        if e.data == b"Home_admin":
            await e.edit("üëÆ <b>PANNELLO ADMIN</b>üëÆ\n\nüë§ User: <b>" + sender.first_name + "</b>\nüÜî <b>" + str(sender.id) + "</b>.\n\n‚Ü™Ô∏è Naviga tra imen√π tramite le opzioni sotto-stanti per gestire l'utenza e le opzioni amministrative.",
                buttons=[[Button.inline("üëÆ ADMIN üëÆ", "lista_admin"), Button.inline("üë• UTENTI üë•", "admin_utenti")],
                    [Button.inline("‚õî BAN ‚õî", "admin_ban"), Button.inline("üõí SHOP üõí", "admin_shop")],
                    [Button.inline("üìÅ GESTIONE FILE üìÅ", "gestione_file"), Button.inline("üí¨ MESSAGGIO GLOBALE üí¨", "messaggio_globale")],
                    [Button.inline("üí≥ METODI DI PAGAMENTO üí≥", "metodi_pagamento"), Button.inline("üõ°Ô∏è TOS üõ°Ô∏è", "admin_tos")]])
        
        
        
        
        elif e.data == b"admin_ban":
            file = open("admin/lista_ban", "r", encoding='utf-8')
            bannati = file.read()
            file.close()
            
            if bannati == "":
                mex = "‚ùå NESSUN UTENTE BANNATO ‚ùå"
            
            else:
                mex = bannati
            
            await e.edit("‚õî <b>BAN</b> ‚õî\n\n‚ÑπÔ∏è Di seguito sono riportati tutti gli ID degli utenti bannati:\n\n\n" + mex,
                buttons=[[Button.inline("‚õî BANNA UN UTENTE ‚õî", "ban_user")],
                    [Button.inline("üîì SBANNA UN UTENTE üîì", "unban_user")],
                    [Button.inline("‚¨ÖÔ∏è INDIETRO", "Home_admin")]])
        
        
        
        
        elif e.data == b"ban_user":
            file = open("admin/stato", "w")
            file.truncate(0)
            file.write("ban_user")
            file.close()
            
            await e.edit("‚õî <b>BANNA UN UTENTE</b> ‚õî\n\n‚ÑπÔ∏è Invia qui di seguito l'ID dell'utente da bannare da " + bot_name + ".",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "admin_ban")]])
        
        
        
        
        elif e.data == b"unban_user":
            file = open("admin/stato", "w")
            file.truncate(0)
            file.write("unban_user")
            file.close()
            
            await e.edit("üîì <b>SBANNA UN UTENTE</b> üîì\n\n‚ÑπÔ∏è Invia qui di seguito l'ID dell'utente da sbannare da " + bot_name + ".",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "admin_ban")]])
        
        
        
        
        elif e.data == b"admin_tos":
            file = open("admin/tos", "r", encoding='utf-8')
            tos = file.read()
            file.close()
            
            file = open("admin/stato", "w")
            file.truncate(0)
            file.close()
            
            if tos == "":
                await e.edit("‚ùå TOS NON IMPOSTATO ‚ùå",
                    buttons=[[Button.inline("‚úèÔ∏è MODIFICA ‚úèÔ∏è", "modifica_tos")],
                        [Button.inline("‚¨ÖÔ∏è INDIETRO", "Home_admin")]])
            
            else:
                await e.edit(tos,
                    buttons=[[Button.inline("‚úèÔ∏è MODIFICA ‚úèÔ∏è", "modifica_tos")],
                        [Button.inline("‚¨ÖÔ∏è INDIETRO", "Home_admin")]])
        
        
        
        
        elif e.data == b"modifica_tos":
            file = open("admin/stato", "w")
            file.truncate(0)
            file.write("modifica_tos")
            file.close()
            
            await e.edit("‚ÑπÔ∏è Inoltra o scrivi, quindi invia qui di seguito il messaggio dei tuoi TOS (Termini di servizio). Puoi usare anche l'HTML per la formattazione del testo.",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "admin_tos")]])
        
        
        
        
        elif e.data == b"lista_admin":
            if user_callback == admin_id:
                file = open("admin/stato", "w")
                file.truncate(0)
                file.close()
                
                file = open("admin/lista_admin", "r", encoding='utf8')
                admins = file.read()
                file.close()
                
                file = open("admin/lista_admin", "r", encoding='utf-8')
                admins = file.read()
                file.close()
                
                if admins == "":
                    await e.edit("üëÆ <b>LISTA ADMIN</b>üëÆ\n\n‚ÑπÔ∏è Di seguito sono riportati tutti gli admin da te approvati. Questi utenti hanno accesso alle opzioni amministrative.\n\n\n‚ùå NESSUN ADMIN AGGIUNTO ‚ùå",
                        buttons=[[Button.inline("‚ûï AGGIUNGI ADMIN ‚ûï", "add_admin"), Button.inline("‚ûñ RIMUOVI ADMIN ‚ûñ", "remove_admin")],
                            [Button.inline("‚¨ÖÔ∏è INDIETRO", "Home_admin")]])
                
                else:
                    await e.edit("üëÆ <b>LISTA ADMIN</b>üëÆ\n\n‚ÑπÔ∏è Di seguito sono riportati tutti gli admin da te approvati. Questi utenti hanno accesso alle opzioni amministrative.\n\n\n" + admins,
                        buttons=[[Button.inline("‚ûï AGGIUNGI ADMIN ‚ûï", "add_admin"), Button.inline("‚ûñ RIMUOVI ADMIN ‚ûñ", "remove_admin")],
                            [Button.inline("‚¨ÖÔ∏è INDIETRO", "Home_admin")]])
            
            else:
                await e.answer("‚ùå ERRORE ‚ùå\n\n‚ÑπÔ∏è Solo il propietario del BOT pu√≤ accedere a questa sezione.", alert=True)
        
        
        
        
        elif e.data == b"add_admin":
            if user_callback == admin_id:
                file = open("admin/stato", "w")
                file.truncate(0)
                file.write("add_admin")
                file.close()
                
                await e.edit("üëÆ <b>AGGIUNGI ADMIN</b>üëÆ\n\n‚ÑπÔ∏è Invia qui di seguito l'ID utente Telegram da aggiungere come admin di " + bot_name + ".",
                    buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "lista_admin")]])
            
            else:
                await e.answer("‚ùå ERRORE ‚ùå\n\n‚ÑπÔ∏è Solo il propietario del BOT pu√≤ accedere a questa sezione.", alert=True)
        
        
        
        
        elif e.data == b"remove_admin":
            if user_callback == admin_id:
                file = open("admin/stato", "w")
                file.truncate(0)
                file.write("remove_admin")
                file.close()
                
                await e.edit("üëÆ <b>RIMUOVI ADMIN</b>üëÆ\n\n‚ÑπÔ∏è Invia qui di seguito l'ID utente Telegram da rimuovere dalla lista admin di " + bot_name + ".",
                    buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "lista_admin")]])
            
            else:
                await e.answer("‚ùå ERRORE ‚ùå\n\n‚ÑπÔ∏è Solo il propietario del BOT pu√≤ accedere a questa sezione.", alert=True)
        
        
        
        
        elif e.data == b"metodi_pagamento":
            await e.edit("üí≥ <b>METODI DI PAGAMENTO</b> üí≥\n\n‚ÑπÔ∏è Premi sui pulsanti che riportano i metodi di pagamento, per attivarli o disattivarli e modificarli. Questi metodi sono utilizzati dagli utenti per ricaricare il saldo del BOT.",
                buttons=[[Button.inline("‚úÖ PAYPAL ‚úÖ", "metodo_paypal")],
                    [Button.inline("ü™ô BITCOIN (BTC)", "metodo_bitcoin"), Button.inline("ü™ô MONERO (XMR)", "metodo_monero")],
                    [Button.inline("‚¨ÖÔ∏è INDIETRO", "Home_admin")]])
        
        
        
        
        elif e.data == b"metodo_paypal":
            file = open("admin/pagamenti/paypal", "r", encoding='utf-8')
            paypal_status = file.read()
            file.close()
            
            pulsanti = []
            
            if paypal_status == "Disabled":
                stato = "disabilitato e NON pu√≤ essere utilizzato dagli utenti come metodo di ricarica del proprio saldo su " + bot_name + "."
                pulsanti.append([Button.inline("PAYPAL ‚ùå", "attiva_metodo_paypal")])
            
            else:
                stato = "abilitato e pu√≤ essere utilizzato dagli utenti come metodo di ricarica del proprio saldo su " + bot_name + "."
                pulsanti.append([Button.inline("PAYPAL ‚úÖ", "disattiva_metodo_paypal")])
            
            
            pulsanti.append([Button.inline("‚¨ÖÔ∏è INDIETRO", "metodi_pagamento")])
            
            await e.edit("üí≥ <b>METODO PAYPAL</b> üí≥\n\n‚ÑπÔ∏è Attualmente il metodo PayPal risulta <b>" + stato + "</b>",
                buttons=pulsanti)
        
        
        
        
        elif e.data == b"attiva_metodo_paypal":
            file = open("admin/stato", "w")
            file.truncate(0)
            file.write("attiva_metodo_paypal")
            file.close()
            
            await e.edit("üí≥ <b>METODO PAYPAL</b> üí≥\n\n‚ÑπÔ∏è Invia di seguito una descrizione o un tutorial per l'utente di come effettuare il pagamento compreso il link, email o altro per farti pagare con questo metodo di pagamento.",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "metodo_paypal")]])
        
        
        
        
        elif e.data == b"disattiva_metodo_paypal":
            file = open("admin/pagamenti/paypal", "w", encoding='utf-8')
            file.truncate(0)
            file.write("Disabled")
            file.close()
            
            await e.edit("‚úÖ Metodo disabilitato correttamente.",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "metodo_paypal")]])
        
        
        
        
        elif e.data == b"metodo_bitcoin":
            file = open("admin/pagamenti/bitcoin", "r", encoding='utf-8')
            bitcoin_status = file.read()
            file.close()
            
            pulsanti = []
            
            if bitcoin_status == "Disabled":
                stato = "disabilitato e NON pu√≤ essere utilizzato dagli utenti come metodo di ricarica del proprio saldo su " + bot_name + "."
                pulsanti.append([Button.inline("BITCOIN ‚ùå", "attiva_metodo_bitcoin")])
            
            else:
                stato = "abilitato e pu√≤ essere utilizzato dagli utenti come metodo di ricarica del proprio saldo su " + bot_name + "."
                pulsanti.append([Button.inline("BITCOIN ‚úÖ", "disattiva_metodo_bitcoin")])
            
            
            pulsanti.append([Button.inline("‚¨ÖÔ∏è INDIETRO", "metodi_pagamento")])
            
            await e.edit("üí≥ <b>METODO BITCOIN (BTC)</b> üí≥\n\n‚ÑπÔ∏è Attualmente il metodo Bitcoin risulta <b>" + stato + "</b>",
                buttons=pulsanti)
        
        
        
        
        elif e.data == b"attiva_metodo_bitcoin":
            file = open("admin/stato", "w")
            file.truncate(0)
            file.write("attiva_metodo_bitcoin")
            file.close()
            
            await e.edit("üí≥ <b>METODO BITCOIN (BTC)</b> üí≥\n\n‚ÑπÔ∏è Invia di seguito una descrizione o un tutorial per l'utente di come effettuare il pagamento compreso il wallet o altro per farti pagare con questo metodo di pagamento.",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "metodo_bitcoin")]])
        
        
        
        
        elif e.data == b"disattiva_metodo_bitcoin":
            file = open("admin/pagamenti/bitcoin", "w", encoding='utf-8')
            file.truncate(0)
            file.write("Disabled")
            file.close()
            
            await e.edit("‚úÖ Metodo disabilitato correttamente.",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "metodo_bitcoin")]])
        
        
        
        
        elif e.data == b"metodo_monero":
            file = open("admin/pagamenti/monero", "r", encoding='utf-8')
            monero_status = file.read()
            file.close()
            
            pulsanti = []
            
            if monero_status == "Disabled":
                stato = "disabilitato e NON pu√≤ essere utilizzato dagli utenti come metodo di ricarica del proprio saldo su " + bot_name + "."
                pulsanti.append([Button.inline("MONERO ‚ùå", "attiva_metodo_monero")])
            
            else:
                stato = "abilitato e pu√≤ essere utilizzato dagli utenti come metodo di ricarica del proprio saldo su " + bot_name + "."
                pulsanti.append([Button.inline("MONERO ‚úÖ", "disattiva_metodo_monero")])
            
            
            pulsanti.append([Button.inline("‚¨ÖÔ∏è INDIETRO", "metodi_pagamento")])
            
            await e.edit("üí≥ <b>METODO MONERO (XMR)</b> üí≥\n\n‚ÑπÔ∏è Attualmente il metodo Monero risulta <b>" + stato + "</b>",
                buttons=pulsanti)
        
        
        
        
        elif e.data == b"attiva_metodo_monero":
            file = open("admin/stato", "w")
            file.truncate(0)
            file.write("attiva_metodo_monero")
            file.close()
            
            await e.edit("üí≥ <b>METODO MONERO (XMR)</b> üí≥\n\n‚ÑπÔ∏è Invia di seguito una descrizione o un tutorial per l'utente di come effettuare il pagamento compreso il wallet o altro per farti pagare con questo metodo di pagamento.",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "metodo_bitcoin")]])
        
        
        
        
        elif e.data == b"disattiva_metodo_monero":
            file = open("admin/pagamenti/monero", "w", encoding='utf-8')
            file.truncate(0)
            file.write("Disabled")
            file.close()
            
            await e.edit("‚úÖ Metodo disabilitato correttamente.",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "metodo_monero")]])
        
        
        
        
        elif data[0] == "get_cronologia_user":
            id_user = data[1]
            path = "utenti/" + id_user + "/"
            
            file = open(path + "cronologia", "r", encoding='utf8')
            cronologia = file.read()
            file.close()
            
            if cronologia == "":
                await e.answer("‚ùå ERRORE ‚ùå\n\n‚ÑπÔ∏è L'utente " + id_user + " non ha effettuato nessun ordine.", alert=True)
            
            else:
                await e.respond(cronologia,
                    buttons=[[Button.inline("‚ùå CHIUDI ‚ùå", "get_cronologia_user_close")]])
        
        
        
        
        elif e.data == b"get_cronologia_user_close":
            await e.delete()
        
        
        
        
        elif e.data == b"admin_utenti":
            file = open("admin/stato", "w")
            file.truncate(0)
            file.close()
            
            utenti = os.listdir("utenti/")
            utenti_num = len(utenti)
            i = -1
            mex = ""
            
            while i < utenti_num - 1:
                i = i + 1
                mex = mex + "\n‚Ü™Ô∏è " + utenti[i]
            
            await e.edit("üë• <b>LISTA UTENTI</b> üë•\n‚ÑπÔ∏è Di seguito sono presenti tutti gli ID degli utenti che hanno avviato il BOT (TOT: " + str(utenti_num) + ").\n\n" + mex,
                buttons=[[Button.inline("‚ûï AGGIUNGI SALDO ‚ûï", "add_saldo"), Button.inline("‚ûñ RIMUOVI SALDO ‚ûñ", "rimuovi_saldo")],
                    [Button.inline("‚ÑπÔ∏è OTTIENI INFO USER ‚ÑπÔ∏è", "get_info_user")],
                    [Button.inline("‚¨ÖÔ∏è INDIETRO", "Home_admin")]])
        
        
        
        
        elif e.data == b"add_saldo":
            file = open("admin/stato", "w")
            file.truncate(0)
            file.write("add_saldo")
            file.close()
            
            await e.edit("‚ûï <b>AGGIUNGI SALDO</b> ‚ûï\n‚ÑπÔ∏è Invia di seguito l'ID utente Telegram + il saldo da aggiungere.\n\nüó® <i>Ad es. 1214002398 5,00</i>",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "admin_utenti")]])
        
        
        
        
        elif e.data == b"rimuovi_saldo":
            file = open("admin/stato", "w")
            file.truncate(0)
            file.write("rimuovi_saldo")
            file.close()
            
            await e.edit("‚ûñ <b>RIMUOVI SALDO</b> ‚ûñ\n‚ÑπÔ∏è Invia di seguito l'ID utente Telegram + il saldo da rimuovere.\n\nüó® <i>Ad es. 1214002398 5,00</i>",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "admin_utenti")]])
        
        
        
        
        elif e.data == b"get_info_user":
            file = open("admin/stato", "w")
            file.truncate(0)
            file.write("get_info_user")
            file.close()
            
            await e.edit("üë• <b>OTTIENI INFO</b> üë•\n‚ÑπÔ∏è Invia di seguito l'ID utente Telegram dalla quale ricavare tutte le informazioni sulla sua attivit√† nel BOT.",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "admin_utenti")]])
        
        
        
        
        elif e.data == b"messaggio_globale":
            file = open("admin/stato", "w")
            file.truncate(0)
            file.write("messaggio_globale")
            file.close()
            
            await e.edit("üí¨ <b>MESSAGGIO GLOBALE</b> üí¨\n\n‚ÑπÔ∏è Invia qui di seguito il messaggio che verr√† recapitato a tutti gli utenti che hanno avviato il BOT.",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "Home_admin")]])
        
        
        
        
        elif e.data == b"admin_shop":
            file = open("admin/stato", "w")
            file.truncate(0)
            file.close()
        
            categorie = os.listdir("prodotti/")
            categorie_num = len(categorie)
            i = -1
            pulsanti = [[Button.inline("‚ûï AGGIUNGI CATEGORIA ‚ûï", "aggiungi_categoria")]]
            
            while i < categorie_num - 1:
                i = i + 1
                pulsanti.append([Button.inline(categorie[i], "categoria_selezionata" + categorie[i])])
            
            pulsanti.append([Button.inline("‚¨ÖÔ∏è INDIETRO", "Home_admin")])
            
            await e.edit("üõç <b>CATEGORIE</b> üõç\n\n‚ÑπÔ∏è Seleziona o aggiungi una nuova categoria.",
                buttons=pulsanti)
        
        
        
        
        elif e.data.__contains__(b"categoria_selezionata"):
            data_callback = e.data.decode('utf-8')
            categoria_selezionata = data_callback.replace("categoria_selezionata", "")
            path = "prodotti/" + categoria_selezionata + "/"
            
            file = open("admin/stato", "w", encoding='utf8')
            file.truncate(0)
            file.write(categoria_selezionata)
            file.close()
            
            prodotti = os.listdir(path)
            prodotti_num = len(prodotti)
            i = -1
            pulsanti = [[Button.inline("‚ûï PRODOTTO ‚ûï", "aggiungi_prodotto"), Button.inline("‚úèÔ∏è NOME CATEG. ‚úèÔ∏è", "nome_categoria"), Button.inline("üóë ELIMINA üóë", "elimina_categoria")]]
            
            while i < prodotti_num - 1:
                i = i + 1
                pulsanti.append([Button.inline(prodotti[i], "prodotto_selezionato" + prodotti[i])])
            
            pulsanti.append([Button.inline("‚¨ÖÔ∏è INDIETRO", "admin_shop")])
            
            await e.edit("üõç CATEGORIA SELEZIONATA: <b>" + categoria_selezionata + "</b>",
                buttons=pulsanti)
        
        
        
        
        elif e.data == b"nome_categoria":
            file = open("admin/stato", "r", encoding='utf8')
            categoria_selezionata = file.read()
            file.close()
            
            file = open("admin/stato", "w", encoding='utf8')
            file.truncate(0)
            file.write(categoria_selezionata + "\nnome_categoria")
            file.close()
            
            await e.edit("‚úèÔ∏è MODIFICA NOME DELLA CATEGORIA " + categoria_selezionata + "\n\n‚ÑπÔ∏è Invia qui di seguito il nuovo nome da applicare alla categoria selezionata.",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "admin_shop")]])
        
        
        
        
        elif e.data == b"elimina_categoria":
            file = open("admin/stato", "r", encoding='utf8')
            categoria_selezionata = file.read()
            file.close()
            
            await e.edit("‚ö†Ô∏è STAI PER ELIMINARE LA CATEGORIA " + categoria_selezionata + "\n\n‚ÑπÔ∏è Sei sicuro di voler eseguire questa azione? Ricordati che √® irreversibile e perderai tutti i prodotti nella categoria.",
                buttons=[[Button.inline("‚úÖ CONFERMA ‚úÖ", "elimina_categoria_yes"), Button.inline("‚ùå ANNULLA ‚ùå", "admin_shop")]])
        
        
        
        
        elif e.data == b"elimina_categoria_yes":
            file = open("admin/stato", "r", encoding='utf8')
            categoria_selezionata = file.read()
            file.close()
            
            shutil.rmtree("prodotti/" + categoria_selezionata + "/")
            
            await e.edit("‚úÖ Operazione eseguita correttamente.",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "admin_shop")]])
        
        
        
        
        elif e.data == b"aggiungi_categoria":
            file = open("admin/stato", "w")
            file.truncate(0)
            file.write("aggiungi_categoria")
            file.close()
            
            await e.edit("‚úèÔ∏è Invia qui di seguito il nome della nuova categoria da inserire",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "admin_shop")]])
        
        
        
        
        elif e.data == b"aggiungi_prodotto":
            file = open("admin/stato", "r", encoding='utf8')
            stato = file.read()
            file.close()
            
            file = open("admin/stato", "r", encoding='utf8')
            categoria_selezionata = file.read().splitlines()
            file.close()
            
            file = open("admin/stato", "w", encoding='utf8')
            file.truncate(0)
            file.write(stato + "\naggiungi_prodotto")
            file.close()
            
            await e.edit("‚úèÔ∏è Invia qui di seguito il nome del nuovo prodotto da inserire nella categoria <b>" + categoria_selezionata[0] + "</b>",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "admin_shop")]])
        
        
        
        
        elif e.data.__contains__(b"prodotto_selezionato"):
            file = open("admin/stato", "r", encoding='utf8')
            categoria_selezionata = file.read()
            file.close()
            
            data_callback = e.data.decode('utf-8')
            prodotto_selezionato = data_callback.replace("prodotto_selezionato", "")
            
            path = "prodotti/" + categoria_selezionata + "/" + prodotto_selezionato + "/"
            
            file = open("admin/stato", "w", encoding='utf8')
            file.truncate(0)
            file.write(categoria_selezionata + "\n" + prodotto_selezionato)
            file.close()
            
            file = open(path + "nome", "r", encoding='utf8')
            nome = file.read()
            file.close()
            
            file = open(path + "descrizione", "r", encoding='utf8')
            descrizione = file.read()
            file.close()
            
            file = open(path + "prezzo", "r", encoding='utf8')
            prezzo = file.read()
            file.close()
            
            file = open(path + "tipologia", "r", encoding='utf8')
            tipologia = file.read().splitlines()
            file.close()
            
            if tipologia[0] == "file":
                button_type = [Button.inline("üìÅ IMPOSTA FILE üìÅ", "imposta_file")]
            
            elif tipologia[0] == "account":
                button_type = [Button.inline("üë§ IMPOSTA ACCOUNTS üë§", "pannello_account")]
            
            await e.edit("üõí Nome prodotto: <b>" + prodotto_selezionato + "</b>\nüè∑ Tipologia: " + tipologia[0] + "\nüí≥ Prezzo: <b>" + prezzo.replace(".", ",") + " EUR</b>\n\nüîª Descrizione: <b>" + descrizione + "</b>",
                buttons=[[Button.inline("‚úèÔ∏è NOME PRODOTTO ‚úèÔ∏è", "nome_prodotto"), Button.inline("üìú DESC. PRODOTTO üìú", "descrizione_prodotto"), Button.inline("üóë ELIMINA üóë", "elimina_prodotto")],
                    [Button.inline("‚ÑπÔ∏è TIPOLOGIA ‚ÑπÔ∏è", "tipologia_prodotto"), Button.inline("üí≥ MODIFICA PREZZO üí≥", "prezzo_prodotto")],
                    button_type,
                    [Button.inline("‚¨ÖÔ∏è INDIETRO", "admin_shop")]])
        
        
        
        
        elif e.data.__contains__(b"return_prodotto_scelto"):
            file = open("admin/stato", "r", encoding='utf8')
            reset = file.read()
            file.close()
            
            
            file = open("admin/stato", "r", encoding='utf8')
            stato = file.read().splitlines()
            file.close()
            
            
            try:
                check = stato[2]
                
                file = open("admin/stato", "w", encoding='utf8')
                file.truncate(0)
                file.write(reset.replace(stato[2], "").strip('\n'))
                file.close()
            
            except:
                pass
            
            
            categoria_selezionata = stato[0]
            prodotto_selezionato = stato[1]
            
            path = "prodotti/" + categoria_selezionata + "/" + prodotto_selezionato + "/"
            
            file = open(path + "nome", "r", encoding='utf8')
            nome = file.read()
            file.close()
            
            file = open(path + "descrizione", "r", encoding='utf8')
            descrizione = file.read()
            file.close()
            
            file = open(path + "prezzo", "r", encoding='utf8')
            prezzo = file.read()
            file.close()
            
            file = open(path + "tipologia", "r", encoding='utf8')
            tipologia = file.read().splitlines()
            file.close()
            
            if tipologia[0] == "file":
                button_type = [Button.inline("üìÅ IMPOSTA FILE üìÅ", "imposta_file")]
            
            elif tipologia[0] == "account":
                button_type = [Button.inline("üë§ IMPOSTA ACCOUNTS üë§", "pannello_account")]
            
            await e.edit("üõí Nome prodotto: <b>" + prodotto_selezionato + "</b>\nüè∑ Tipologia: " + tipologia[0] + "\nüí≥ Prezzo: <b>" + prezzo.replace(".", ",") + " EUR</b>\n\nüîª Descrizione: <b>" + descrizione + "</b>",
                buttons=[[Button.inline("‚úèÔ∏è NOME PRODOTTO ‚úèÔ∏è", "nome_prodotto"), Button.inline("üìú DESC. PRODOTTO üìú", "descrizione_prodotto"), Button.inline("üóë ELIMINA üóë", "elimina_prodotto")],
                    [Button.inline("‚ÑπÔ∏è TIPOLOGIA ‚ÑπÔ∏è", "tipologia_prodotto"), Button.inline("üí≥ MODIFICA PREZZO üí≥", "prezzo_prodotto")],
                    button_type,
                    [Button.inline("‚¨ÖÔ∏è INDIETRO", "admin_shop")]])
        
        
        
        
        elif e.data == b"gestione_file":
            file = open("admin/stato", "w", encoding='utf8')
            file.truncate(0)
            file.close()
            
            all_file = os.listdir("files/")
            all_file_num = len(all_file)
            i = -1
            data = ""
            
            while i < all_file_num - 1:
                i = i + 1
                data = data + "\n- " + all_file[i]
            
            await e.edit("üìÅ DI SEGUITO SONO PRESENTI TUTTI I FILE NEL DATABASE:\n\n‚ÑπÔ∏è Questi file vengono consegnati automaticamente all'acquisto del prodotto. Per impostare un file specifico a seconda del prodotto, recati nella pagina del prodotto che desideri.\n\n" + data,
                buttons=[[Button.inline("‚ûï AGGIUNGI FILE ‚ûï", "aggiungi_file"), Button.inline("‚¨áÔ∏è SCARICA FILE ‚¨áÔ∏è", "scarica_file"), Button.inline("‚ûñ RIMUOVI FILE ‚ûñ", "rimuovi_file")],
                    [Button.inline("‚¨ÖÔ∏è INDIETRO", "Home_admin")]])
        
        
        
        
        elif e.data == b"scarica_file":
            file = open("admin/stato", "w", encoding='utf8')
            file.truncate(0)
            file.write("scarica_file")
            file.close()
            
            await e.edit("‚ÑπÔ∏è Invia qui di seguito il nome del file da scaricare (compresa l'estensione).",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "gestione_file")]])
        
        
        
        
        elif e.data == b"aggiungi_file":
            file = open("admin/stato", "w", encoding='utf8')
            file.truncate(0)
            file.write("aggiungi_file")
            file.close()
            
            await e.edit("‚ÑπÔ∏è Invia qui di seguito nome da dare al file che successivamente andrai ad uplodare nel database del BOT (compresa l'estensione finale). Nota che se inserisci un nome gi√† esistente, il vecchio file verr√† sostituito con questo nuovo.",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "gestione_file")]])
        
        
        
        
        elif e.data == b"rimuovi_file":
            file = open("admin/stato", "w", encoding='utf8')
            file.truncate(0)
            file.write("rimuovi_file")
            file.close()
            
            await e.edit("‚ÑπÔ∏è Invia qui di seguito nome del file da rimuovere (compresa l'estensione finale).",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "gestione_file")]])
        
        
        
        
        elif e.data == b"nome_prodotto":
            file = open("admin/stato", "r", encoding='utf-8')
            stato = file.read().splitlines()
            file.close()
            
            file = open("admin/stato", "r", encoding='utf-8')
            stato2 = file.read()
            file.close()
            
            file = open("admin/stato", "w", encoding='utf8')
            file.truncate(0)
            file.write(stato2 + "\nnome_prodotto")
            file.close()
            
            categoria_selezionata = stato[0]
            prodotto_selezionato = stato[1]
            
            await e.edit("‚ÑπÔ∏è Invia qui di seguito il nuovo nome da applicare al prodotto <b>" + prodotto_selezionato + "</b>.",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "return_prodotto_scelto")]])
        
        
        
        
        elif e.data == b"descrizione_prodotto":
            file = open("admin/stato", "r", encoding='utf8')
            stato = file.read().splitlines()
            file.close()
            
            categoria_selezionata = stato[0]
            prodotto_selezionato = stato[1]
            
            file = open("admin/stato", "r", encoding='utf8')
            stato2 = file.read()
            file.close()
            
            file = open("admin/stato", "w", encoding='utf8')
            file.truncate(0)
            file.write(stato2 + "\ndescrizione_prodotto")
            file.close()
            
            await e.edit("‚ÑπÔ∏è Invia qui di seguito la nuova descrizione da applicare al prodotto <b>" + prodotto_selezionato + "</b>.",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "return_prodotto_scelto")]])
        
        
        
        
        elif e.data == b"elimina_prodotto":
            file = open("admin/stato", "r", encoding='utf8')
            stato = file.read().splitlines()
            file.close()
            
            categoria_selezionata = stato[0]
            prodotto_selezionato = stato[1]
            
            await e.edit("‚ö†Ô∏è ELIMINA " + prodotto_selezionato + " ‚ö†Ô∏è\n\n‚ÑπÔ∏è Sei sicuro di voler eliminare il prodotto <b>" + prodotto_selezionato + "</b>? Nota che tutti le modifiche e progressi salvati verranno eliminati permanentemente. Questa azione √® irreversibile.",
                buttons=[[Button.inline("‚úÖ CONFERMA ‚úÖ", "elimina_prodotto_yes"), Button.inline("‚ùå ANNULLA ‚ùå", "return_prodotto_scelto")]])
        
        
        
        
        elif e.data == b"elimina_prodotto_yes":
            file = open("admin/stato", "r", encoding='utf8')
            stato = file.read().splitlines()
            file.close()
            
            categoria_selezionata = stato[0]
            prodotto_selezionato = stato[1]
            
            path = "prodotti/" + categoria_selezionata + "/" + prodotto_selezionato + "/"
            
            shutil.rmtree(path)
            
            await e.edit("‚úÖ OPERAZIONE ESEGUITA CORRETTAMENTE ‚úÖ",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "admin_shop")]])
        
        
        
        
        elif e.data == b"tipologia_prodotto":
            file = open("admin/stato", "r", encoding='utf8')
            stato = file.read().splitlines()
            file.close()
            
            categoria_selezionata = stato[0]
            prodotto_selezionato = stato[1]
            
            path = "prodotti/" + categoria_selezionata + "/" + prodotto_selezionato + "/"
            
            file = open(path + "tipologia", "r", encoding='utf8')
            tipologia = file.read().splitlines()
            file.close()
            
            if tipologia[0] == "account":
                pulsanti = [[Button.inline("FILE", "change_file"), Button.inline("ACCOUNT üîò", "change_account")]]
            
            elif tipologia[0] == "file":
                pulsanti = [[Button.inline("FILE üîò", "change_file"), Button.inline("ACCOUNT", "change_account")]]
            
            pulsanti.append([Button.inline("‚¨ÖÔ∏è INDIETRO", "return_prodotto_scelto")])
            
            await e.edit("‚ÑπÔ∏è Visualizza o modifica la tipologia del prodotto <b>" + prodotto_selezionato + "</b>",
                buttons=pulsanti)
        
        
        
        
        elif e.data == b"change_account":
            file = open("admin/stato", "r", encoding='utf8')
            stato = file.read().splitlines()
            file.close()
            
            categoria_selezionata = stato[0]
            prodotto_selezionato = stato[1]
            
            path = "prodotti/" + categoria_selezionata + "/" + prodotto_selezionato + "/"
            
            file = open(path + "tipologia", "w", encoding='utf8')
            file.truncate(0)
            file.write("account")
            file.close()
            
            await e.edit("‚úÖ CATEGORIA PRODOTTO CAMBIATA ‚úÖ",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "tipologia_prodotto")]])
        
        
        
        
        elif e.data == b"change_file":
            file = open("admin/stato", "r", encoding='utf8')
            stato = file.read().splitlines()
            file.close()
            
            categoria_selezionata = stato[0]
            prodotto_selezionato = stato[1]
            
            path = "prodotti/" + categoria_selezionata + "/" + prodotto_selezionato + "/"
            
            file = open(path + "tipologia", "w", encoding='utf8')
            file.truncate(0)
            file.write("file")
            file.close()
            
            await e.edit("‚úÖ CATEGORIA PRODOTTO CAMBIATA ‚úÖ",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "tipologia_prodotto")]])
        
        
        
        
        elif e.data == b"imposta_file":
            file = open("admin/stato", "r", encoding='utf8')
            stato = file.read().splitlines()
            file.close()
            
            categoria_selezionata = stato[0]
            prodotto_selezionato = stato[1]
            
            path = "prodotti/" + categoria_selezionata + "/" + prodotto_selezionato + "/"
            
            
            file = open("admin/stato", "r", encoding='utf8')
            stato_read = file.read()
            file.close()
            
            
            file = open("admin/stato", "w", encoding='utf8')
            file.truncate(0)
            file.write(stato_read + "\nimposta_file")
            file.close()
            
            file = open(path + "tipologia", encoding='utf8')
            file_impostato = file.read().splitlines()
            file.close()
            
            try:
                file_sel = file_impostato[1]
            
            except:
                file_sel = "NESSUN FILE"
            
            await e.edit("üìÅ IMPOSTA FILE DA INVIARE AUTOMATICAMENTE DOPO L'ACQUISTO DEL PRODOTTO <b>" + prodotto_selezionato + "</b>.\n\n‚ÑπÔ∏è Invia qui di seguito il nome del file che hai caricato precedentemente sul database del BOT. Se non ricordi il nome premi sul pulsante sotto-stante per visualizzare tutti i file nel database del BOT.\n\n<b>FILE ATTUALMENTE IMPOSTATO: </b>" + file_sel,
                buttons=[[Button.inline("üëÄ VISUALIZZA I FILES üëÄ", "all_file_view")],
                    [Button.inline("‚¨ÖÔ∏è INDIETRO", "return_prodotto_scelto")]])
        
        
        
        
        elif e.data == b"all_file_view":
            files = os.listdir("files/")
            files_num = len(files)
            i = -1
            mex = ""
            
            while i < files_num - 1:
                i = i + 1
                mex = mex + "\n- " + files[i]
            
            await e.edit("üìÅ TUTTI I FILE NEL DB: üìÅ\n\n" + mex,
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "imposta_file")]])
        
        
        
        
        elif e.data == b"pannello_account":
            file = open("admin/stato", "r", encoding='utf8')
            stato = file.read().splitlines()
            file.close()
            
            categoria_selezionata = stato[0]
            prodotto_selezionato = stato[1]
            
            file = open("admin/stato", "r", encoding='utf8')
            stato_read = file.read()
            file.close()
            
            file = open("admin/stato", "w", encoding='utf8')
            file.truncate(0)
            file.write(stato_read + "\npannello_account")
            file.close()
            
            
            await e.edit("üë§ <b>PANNELLO ACCOUNT</b> üë§\n\n‚ÑπÔ∏è Invia qui di seguito uno o pi√π account da aggiungere alla lista (andando a capo per ogni account). Lo script invier√† automaticamente al cliente un account random dalla lista eliminandolo successivamente.",
                buttons=[[Button.inline("üëÄ VISUALIZZA LISTA üëÄ", "all_account_view")],
                    [Button.inline("‚¨ÖÔ∏è INDIETRO", "return_prodotto_scelto")]])
        
        
        
        
        elif e.data == b"all_account_view":
            file = open("admin/stato", "r", encoding='utf8')
            stato = file.read().splitlines()
            file.close()
            
            categoria_selezionata = stato[0]
            prodotto_selezionato = stato[1]
            
            file = open("admin/stato", "r", encoding='utf8')
            stato_read = file.read()
            file.close()
            
            try:
                check = stato[2]
                file = open("admin/stato", "w", encoding='utf8')
                file.truncate(0)
                file.write(stato_read.replace(stato[2], "").strip("\n"))
                file.close()
            
            except:
                pass
            
            path = "prodotti/" + categoria_selezionata + "/" + prodotto_selezionato + "/"
            
            file = open(path + "accounts", "r", encoding='utf-8')
            accounts = file.read()
            file.close()
            
            if accounts == "":
                await e.edit("üë§ TUTTI GLI ACCOUNT IMPORTATI: üë§\n\n‚ùå NESSUN ACCOUNT IMPOSTATO ‚ùå",
                    buttons=[[Button.inline("‚ûñ RIMUOVI ACCOUNT ‚ûñ", "rimuovi_account"), Button.inline("‚ùå RESETTA LISTA ‚ùå", "resetta_lista")],
                        [Button.inline("‚¨ÖÔ∏è INDIETRO", "pannello_account")]])
            
            else:
                await e.edit("üë§ TUTTI GLI ACCOUNT IMPORTATI: üë§\n\n" + accounts,
                    buttons=[[Button.inline("‚ûñ RIMUOVI ACCOUNT ‚ûñ", "rimuovi_account"), Button.inline("‚ùå RESETTA LISTA ‚ùå", "resetta_lista")],
                        [Button.inline("‚¨ÖÔ∏è INDIETRO", "pannello_account")]])
        
        
        
        
        elif e.data == b"resetta_lista":
            await e.edit("‚ö†Ô∏è <b>CONFERMA ELIMINAZIONE</b> ‚ö†Ô∏è\n\n‚ÑπÔ∏è Sei sicuro di vorre eliminare tutta la lista degli account del prodotto? Questa azione √® irreversibile.",
                buttons=[[Button.inline("‚úÖ CONFERMA ‚úÖ", "resetta_lista_yes"), Button.inline("‚ùå ANNULLA ‚ùå", "all_account_view")]])
        
        
        
        
        elif e.data == b"resetta_lista_yes":
            file = open("admin/stato", "r", encoding='utf8')
            stato = file.read().splitlines()
            file.close()
            
            categoria_selezionata = stato[0]
            prodotto_selezionato = stato[1]
            
            path = "prodotti/" + categoria_selezionata + "/" + prodotto_selezionato + "/"
            
            file = open(path + "accounts", "w")
            file.truncate(0)
            file.close()
            
            await e.edit("‚úÖ OPERAZIONE ESEGUITA CORRETTAMENTE ‚úÖ",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "all_account_view")]])
        
        
        
        
        elif e.data == b"rimuovi_account":
            file = open("admin/stato", "r", encoding='utf8')
            stato_read = file.read()
            file.close()
            
            file = open("admin/stato", "w", encoding='utf8')
            file.truncate(0)
            file.write(stato_read + "\nrimuovi_account")
            file.close()
            
            await e.edit("‚ÑπÔ∏è INVIA DI SEGUITO LA STRINGA DELL'ACCOUNT DA RIMUOVERE DALLA LISTA.",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "all_account_view")]])
        
        
        
        
        elif e.data == b"prezzo_prodotto":
            file = open("admin/stato", "r", encoding='utf8')
            stato = file.read().splitlines()
            file.close()
            
            categoria_selezionata = stato[0]
            prodotto_selezionato = stato[1]
            
            path = "prodotti/" + categoria_selezionata + "/" + prodotto_selezionato + "/"
            
            file = open(path + "prezzo", "r")
            prezzo = file.read()
            file.close()
            
            file = open("admin/stato", "r", encoding='utf8')
            stato_read = file.read()
            file.close()
            
            file = open("admin/stato", "w", encoding='utf8')
            file.truncate(0)
            file.write(stato_read + "\nprezzo_prodotto")
            file.close()
            
            await e.edit("‚ÑπÔ∏è Invia di seguito il nuovo prezzo da modificare al prodotto <b>" + prodotto_selezionato + "</b>.\n\n<b>PREZZO ATTUALE: " + prezzo.replace(".", ",") + "</b> EUR.",
                buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "return_prodotto_scelto")]])
    
    ##################################
    
    
    #----------------------------------------------------------------#
    
    
    ########## SEZIONE UTENTE ##########
    
    else:
        if lista_ban.__contains__(str(user_callback)):
            await e.answer("‚õî SEI STATO BANNATO ‚õî\n\n‚ÑπÔ∏è Spiacenti, ma uno degli amministratori del BOT ha deciso di bannarti. Non potrai utilizzare il BOT e le sue funzioni ammenoch√® non verrai riammesso dallo staff.", alert=True)
        
        else:
            if obbligo == True:
                if e.data == b"check_canale":
                    try:
                        result = await client(functions.channels.GetParticipantRequest(
                        channel=canale_obbligo,
                        participant=int(sender.id)
                        ))
                        
                        await e.respond("‚úÖ <b>SEI ISCRITTO</b> ‚úÖ\n\n‚ÑπÔ∏è Grazie per esserti iscritto a " + canale_obbligo + ". Ora puoi utilizzare il bot",
                            buttons=[[Button.inline("üè† Vai alla Home üè†", "Home")]])
                    
                    except:
                        await e.answer("‚ùå ERRORE ‚ùå\n\n‚ÑπÔ∏è Non sei ancora iscritto al canale " + canale_obbligo + ". Iscriviti per poter utilizzare " + bot_name + ".", alert=True)
                        return
                
                try:
                    result = await client(functions.channels.GetParticipantRequest(
                    channel=canale_obbligo,
                    participant=int(sender.id)
                    ))
                
                except:
                    await e.answer("‚ùå ERRORE ‚ùå\n\n‚ÑπÔ∏è Devi essere iscritto a " + canale_obbligo + " per poter utilizzare " + bot_name + ".", alert=True)
                    return
            
            
            
            
            if e.data == b"Home":
                file = open(userpath + "dataavvio", "r")
                data_ora_avvio = file.read()
                file.close()

                file = open(userpath + "saldo", "r")
                saldo_read = file.read()
                file.close()
                
                saldo = float(saldo_read)
                
                await e.edit("<b> üëãüèª Ciao " + sender.first_name + ".\n\nü§ñ Questo √® lo shop di @fsocietyUserBot\n\nüí≥ Saldo attuale: " + str(format(saldo, ".2f")) + "‚Ç¨</b>",
                    buttons=[[Button.inline("üí∞ Saldo", "wallet"), Button.inline("Shop üõç", "shop")],
                    [Button.inline("üíé Tos", "tos"), Button.inline("Supporto ‚òé", "chatlive")]])
            
            
            
            
            elif e.data == b"tos":
                file = open("admin/tos", "r", encoding='utf-8')
                tos = file.read()
                file.close()
                
                if tos == "":
                    await e.edit("‚ùå NESSUN TOS IMPOSTATO ‚ùå",
                        buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "Home")]])
                
                else:
                    await e.edit("‚ö†Ô∏è PROSEGUENDO CON UN ACQUISTO DA " + bot_name + " CONFERMI E DICHIARI AUTOMATICAMENTE DI AVER PRESO VISIONE ED <b>ACCETTATO</b> I TERMINI DI SERVIZIO SOTTO RIPORTATI:\n\n" + tos,
                        buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "Home")]])
            
            
            
            
            elif e.data == b"chatlive":
                file = open(userpath + "stato", "w")
                file.truncate(0)
                file.write("chatlive")
                file.close()
                
                await e.edit("üí¨ <b>CHAT LIVE</b> üí¨\n\n‚ÑπÔ∏è Qualsiasi messaggio che invierai da ora in poi verr√† recapitato agli admin. Attendi un loro riscontro, riceverai un messaggio sulla messaggistica del BOT. Per chiudere la chat live utilizza il pulsante sotto stante o digita in qualunque momento il comando /annulla.",
                    buttons=[[Button.inline("‚ùå TERMINA CHAT ‚ùå", "termina-chat")]])
            
            
            
            
            elif e.data == b"termina-chat":
                file = open(userpath + "stato", "w")
                file.truncate(0)
                file.close()
                
                await e.edit("‚ùå CHAT-LIVE TERMINATA ‚ùå",
                    buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "Home")]])
            
            
            
            
            elif e.data == b"Homebuy":
                file = open(userpath + "dataavvio", "r")
                data_ora_avvio = file.read()
                file.close()

                file = open(userpath + "saldo", "r")
                saldo_read = file.read()
                file.close()
                
                saldo = float(saldo_read)
                
                await e.respond("<b> üëãüèª Ciao " + sender.first_name + ".\n\nü§ñ Questo √® lo shop di @fsocietyUserBot\n\nüí≥ Saldo attuale: " + str(format(saldo, ".2f")) + "‚Ç¨</b>",
                    buttons=[[Button.inline("üí∞ Saldo", "wallet"), Button.inline("Shop üõç", "shop")],
                    [Button.inline("üíé Tos", "tos"), Button.inline("Supporto ‚òé", "chatlive")]])
            
            
            
            
            
            elif e.data == b"wallet":
                file = open(userpath + "saldo", "r")
                saldo_read = file.read()
                file.close()
                
                saldo = float(saldo_read)
                
                await e.edit("üí∞ <b>WALLET</b> üí∞\n\n‚ÑπÔ∏è Qui di seguito sono presenti tutte le opzioni del tuo saldo e di tutte le tue transazioni.\n\n\nüí≥ Saldo attuale: <b>" + str(format(saldo, ".2f")) + " EUR</b>.",
                    buttons=[[Button.inline("‚ûï RICARICA SALDO ‚ûï", "ricarica_saldo")], 
                    [Button.inline("üïì CRONOLOGIA TRANSAZIONI üïì", "cronologia_transazioni")],
                        [Button.inline("‚¨ÖÔ∏è INDIETRO", "Home")]])
            
            
            
            
            elif e.data == b"ricarica_saldo":
                pulsanti = []
                
                file = open("admin/pagamenti/paypal", "r", encoding='utf8')
                paypal = file.read()
                file.close()
                
                file = open("admin/pagamenti/bitcoin", "r", encoding='utf8')
                bitcoin = file.read()
                file.close()
                
                file = open("admin/pagamenti/monero", "r", encoding='utf8')
                monero = file.read()
                file.close()
                
                if paypal == "Disabled":
                    pass
                
                else:
                    pulsanti.append([Button.inline("‚úÖ PAYPAL ‚úÖ", "ricarica_paypal")])
                
                
                if bitcoin == "Disabled":
                    pass
                
                else:
                    pulsanti.append([Button.inline("ü™ô BITCOIN (BTC) ü™ô", "ricarica_bitcoin")])
                
                
                if monero == "Disabled":
                    pass
                
                else:
                    pulsanti.append([Button.inline("ü™ô MONERO (XMR) ü™ô", "ricarica_monero")])
                
                pulsanti.append([Button.inline("‚¨ÖÔ∏è INDIETRO", "wallet")])
                
                await e.edit("üîÑ <b>RICARICA IL SALDO</b>üîÑ\n\n‚ÑπÔ∏è Seleziona prima di tutto che metodo di pagamento intendi usare per ricaricare il saldo del BOT <b>" + bot_name + "</b>.",
                    buttons=pulsanti)
            
            
            
            
            elif e.data == b"ricarica_paypal":
                file = open("admin/pagamenti/paypal", "r", encoding='utf-8')
                desc = file.read()
                file.close()
                
                await e.edit("üîÑ <b>RICARICA CON PAYPAL</b>üîÑ\n\n‚ÑπÔ∏è " + desc,
                    buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "ricarica_saldo")]])
            
            
            
            
            elif e.data == b"ricarica_bitcoin":
                file = open("admin/pagamenti/bitcoin", "r", encoding='utf-8')
                desc = file.read()
                file.close()
                
                await e.edit("üîÑ <b>RICARICA CON BITCOIN (BTC)</b>üîÑ\n\n‚ÑπÔ∏è " + desc,
                    buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "ricarica_saldo")]])
            
            
            
            
            elif e.data == b"ricarica_monero":
                file = open("admin/pagamenti/monero", "r", encoding='utf-8')
                desc = file.read()
                file.close()
                
                await e.edit("üîÑ <b>RICARICA CON MONERO (XMR)</b>üîÑ\n\n‚ÑπÔ∏è " + desc,
                    buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "ricarica_saldo")]])
            
            
            
            
            elif data[0] == "pagamento_effettuato":
                metodo = data[1]
                
                if metodo == "paypal":
                    mex = "PayPal"
                
                elif metodo == "bitcoin":
                    mex = "Bitcoin (BTC)"
                
                elif metodo == "monero":
                    mex = "Monero (XMR)"
                
                await client.send_message(int(admin_id), "‚úÖ UN UTENTE HA CONFERMATO UN PAGAMENTO ‚úÖ\n\n‚ÑπÔ∏è L'utente <a href='tg://user?id=" + str(sender.id) + "'>" + sender.first_name + "</a> (" + str(sender.id) + ") ha confermato di aver ricaricato e quindi pagato con il metodo di pagamento <b>" + mex + "</b>.\nControlla se ha effettuato il pagamento e ricarica la cifra che ti ha inviato.")
                
                file = open("admin/lista_admin", "r", encoding='utf8')
                admins = file.read().splitlines()
                admins_num = len(admins)
                file.close()
                i = - 1
                
                while i < admins_num - 1:
                    i = i + 1
                    await client.send_message(int(admins[i]), "‚úÖ UN UTENTE HA CONFERMATO UN PAGAMENTO ‚úÖ\n\n‚ÑπÔ∏è L'utente <a href='tg://user?id=" + str(sender.id) + "'>" + sender.first_name + "</a> (" + str(sender.id) + ") ha confermato di aver ricaricato e quindi pagato con il metodo di pagamento <b>" + mex + "</b>.\nControlla se ha effettuato il pagamento e ricarica la cifra che ti ha inviato.")
                
                
                await e.edit("‚úÖ <b>RICHIESTA RICEVUTA</b> ‚úÖ\n\n‚ÑπÔ∏è Abbiamo ricevuto la tua richiesta di ricarica del saldo. Attendi, un nostro staff controller√† il tuo pagamento se risulter√† valido riceverai un riscontro sulla messaggistica del BOT.",
                    buttons=[[Button.inline("‚úÖ CONFERMA ‚úÖ", "Home")]])
            
            
            
            
            elif e.data == b"cronologia_transazioni":
                file = open(userpath + "cronologia", "r", encoding='utf8')
                cronologia = file.read()
                file.close()
                
                if cronologia == "":
                    await e.answer("‚ùå ERRORE ‚ùå\n\n‚ÑπÔ∏è Non hai effettuato nessuna transazione.", alert=True)
                
                else:
                    await e.edit(cronologia,
                        buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "wallet")]])
            
            
            
            
            elif e.data == b"shop":
                categorie = os.listdir("prodotti/")
                
                if categorie == []:
                    await e.edit("‚ùå <b>ERRORE</b> ‚ùå\n\n‚ÑπÔ∏è Attualmente non √® disponibile nessuna categoria.",
                        buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "Home")]])
                
                else:
                    num_categorie = len(categorie)
                    i = -1
                    pulsanti = []
                    
                    while i < num_categorie - 1:
                        i = i + 1
                        pulsanti.append([Button.inline(categorie[i], "categoria_selezionata" + categorie[i])])
                    
                    pulsanti.append([Button.inline("‚¨ÖÔ∏è INDIETRO", "Home")])
                    await e.edit("üõí <b>CATEGORIE</b> üõí\n\n‚ÑπÔ∏è Scegli una categoria tramite i pulsanti sotto-stanti.",
                        buttons=pulsanti)
            
            
            
            
            elif e.data.__contains__(b"categoria_selezionata"):
                data_callback = e.data.decode('utf-8')
                categoria_selezionata_replace = str(data_callback)
                categoria_selezionata = categoria_selezionata_replace.replace("categoria_selezionata", "")
                
                path = "prodotti/" + categoria_selezionata + "/"
                
                prodotti = os.listdir(path)
                
                if prodotti == []:
                    await e.edit("‚ùå <b>ERRORE</b> ‚ùå\n\n‚ÑπÔ∏è Attualmente non √® disponibile nessun prodotto per questa categoria.",
                        buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "Home")]])
                
                else:
                    num_prodotti = len(prodotti)
                    i = -1
                    pulsanti = []
                    
                    while i < num_prodotti - 1:
                        i = i + 1
                        try:
                            adici = os.listdir(path + prodotti[i] + "/")
                            pulsanti.append([Button.inline(prodotti[i], "prodotto_selezionato" + prodotti[i])])
                        
                        except:
                            pass
                    
                    file = open(userpath + "stato", "w", encoding='utf-8')
                    file.truncate(0)
                    file.write(categoria_selezionata)
                    file.close()
                    
                    pulsanti.append([Button.inline("‚¨ÖÔ∏è INDIETRO", "shop")])
                    await e.edit("üõí <b>TUTTI I PRODOTTI</b> üõí\n <i>üî∏ Categoria: " + categoria_selezionata + "</i>\n\n‚ÑπÔ∏è Scegli un prodotto tramite i pulsanti sotto-stanti e procedi successivamente con l'acquisto.",
                        buttons=pulsanti)
            
            
            
            
            elif e.data.__contains__(b"prodotto_selezionato"):
                data_callback = e.data.decode('utf-8')
                prodotto_selezionato_replace = str(data_callback)
                prodotto_selezionato = prodotto_selezionato_replace.replace("prodotto_selezionato", "")
                
                file = open(userpath + "stato", "r", encoding='utf8')
                categoria = file.read()
                file.close()
                
                path = "prodotti/" + categoria + "/" + prodotto_selezionato + "/"
                
                file = open(path + "nome", "r", encoding='utf8')
                nome = file.read()
                file.close()
                
                file = open(path + "descrizione", "r", encoding='utf8')
                descrizione = file.read()
                file.close()
                
                file = open(path + "prezzo", "r", encoding='utf8')
                prezzo = file.read()
                file.close()
                
                file = open(path + "tipologia", "r", encoding='utf8')
                tipologia = file.read()
                file.close()
                
                file = open(userpath + "stato", "w", encoding='utf8')
                file.truncate(0)
                file.write(nome + "\n" + descrizione + "\n" + prezzo + "\n" + tipologia + "\n" + path)
                file.close()
                
                await e.edit("üõí Nome prodotto: <b>" + nome + "</b>\n\n‚ÑπÔ∏è " + descrizione + "\n\nüí∞ Prezzo: <b>" + prezzo.replace(".", ",") + " EUR</b>.",
                    buttons=[[Button.inline("üí≥ ACQUISTA üí≥", "conferma_acquisto")],
                        [Button.inline("‚¨ÖÔ∏è INDIETRO", "shop")]])
            
            
            
            
            elif e.data == b"conferma_acquisto":
                file = open(userpath + "stato", "r", encoding='utf8')
                stato = file.read().splitlines()
                file.close()
                
                await e.edit("‚úÖ <b>CONFERMA ACQUISTO</b> ‚úÖ\n\n‚ÑπÔ∏è Sei sicuro di voler acquistare <b>" + stato[0] + "</b> a <b>" + stato[2].replace(".", ",") + " EUR</b>?",
                    buttons=[[Button.inline("‚úÖ CONFERMA ‚úÖ", "acquisto_confermato"), Button.inline("‚ùå ANNULLA ‚ùå", "shop")]])
            
            
            
            
            elif e.data == b"acquisto_confermato":
                file = open(userpath + "saldo", "r")
                saldo_read = file.read()
                file.close()
                
                saldo = float(saldo_read)
                
                file = open(userpath + "stato", "r", encoding='utf8')
                stato = file.read().splitlines()
                file.close()
                
                prezzo = float(stato[2])
                
                if(saldo < prezzo):
                    await e.edit("‚ùå <b>ERRORE</b>‚ùå\n\n‚ÑπÔ∏è Fondi non sufficenti per completare la transazione. Ricarica il saldo prima di acquistare il prodotto.",
                        buttons=[[Button.inline("‚¨ÖÔ∏è INDIETRO", "shop")]])
                
                elif(saldo >= prezzo):
                    calcolo_finale = saldo - prezzo
                    
                    file = open(userpath + "saldo", "w")
                    file.truncate(0)
                    file.write(str(calcolo_finale))
                    file.close()
                    
                    file = open(userpath + "cronologia", "r", encoding='utf8')
                    cronologia = file.read()
                    file.close()
                    
                    file = open(userpath + "cronologia", "w", encoding='utf8')
                    file.truncate(0)
                    file.write(cronologia + "\n\n\nüõí ACQUISTO üõí\nüõç Prodotto: " + stato[0] + "\nüí≥ Prezzo: -" + stato[2].replace(".", ",") + " EUR\nüïê Data & ora: " + dataora)
                    file.close()
                    
                    try:
                        path = stato[5]
                    
                    except:
                        path = stato[4]
                    
                    file = open(path + "tipologia", "r", encoding='utf8')
                    tipologia = file.read().splitlines()
                    file.close()
                    
                    await e.delete()
                    
                    if tipologia[0] == "file":
                        try:
                            file_send = "files/" + tipologia[1]
                            
                            await client.send_file(int(sender.id), file_send)
                            
                            await e.respond("üéâ <b>ACQUISTO COMPLETATO</b>üéâ\n\nüëç Grazie del tuo acquisto. Il file acquistato lo trovi al di sopra di questo messaggio.",
                                buttons=[[Button.inline("üè† Torna alla Home", "Home")]])
                            

                        except:
                            await e.respond("üéâ <b>ACQUISTO COMPLETATO</b>üéâ\n\nüëç Grazie del tuo acquisto. Il propietario dello SHOP BOT non ha impostato nessun invio automatico dopo l'acquisto del prodotto. Contattalo in chat per sapere come ricevere il prodotto acquistato nel caso si trattasse di una cosa non voluta.",
                                buttons=[[Button.inline("üè† Torna alla Home", "Homebuy")]])
                    
                    elif tipologia[0] == "account":
                        try:
                            file = open(path + "accounts", "r", encoding='utf8')
                            line_count = -1
                            for line in file:
                                if line != "\n":
                                    line_count += 1
                            file.close()
                            
                            numero_rnd = random.randint(0,line_count)
                            
                            
                            file = open(path + "accounts", "r", encoding='utf8')
                            accounts = file.read().splitlines()
                            file.close()
                            
                            
                            file = open(path + "accounts", "r", encoding='utf8')
                            accounts_rpl = file.read()
                            file.close()
                            
                            selezionato = accounts[numero_rnd]
                            
                            replace_acc = accounts_rpl.replace(selezionato, "").strip('\n')
                            
                            if line_count <= 1:
                                file = open(path + "accounts", "w", encoding='utf8')
                                file.truncate(0)
                                file.close()
                            
                            else:
                                file = open(path + "accounts", "w", encoding='utf8')
                                file.truncate(0)
                                file.write(replace_acc)
                                file.close()
                            
                            
                            await e.respond("üéâ <b>ACQUISTO COMPLETATO</b>üéâ\n\nüëç Grazie del tuo acquisto, ecco il tuo account:\n\n<pre>" + accounts[numero_rnd] + "</pre>",
                                buttons=[[Button.inline("üè† Torna alla Home", "Homebuy")]])
                        
                        except:
                            await e.respond("üéâ <b>ACQUISTO COMPLETATO</b>üéâ\n\nüëç Grazie del tuo acquisto. Il propietario dello SHOP BOT non ha impostato nessun invio automatico dopo l'acquisto del prodotto. Contattalo in chat per sapere come ricevere il prodotto acquistato nel caso si trattasse di una cosa non voluta.",
                                buttons=[[Button.inline("üè† Torna alla Home", "Homebuy")]])
                    
                    
                    file = open("admin/lista_admin", "r", encoding='utf8')
                    admins = file.read().splitlines()
                    admins_num = len(admins)
                    file.close()
                    i = - 1
                    
                    await client.send_message(int(admin_id), "üõí ACQUISTO üõí\n\nüë§ L'utente <a href='tg://user?id=" + str(sender.id) + "'>" + sender.first_name + "</a> (" + str(sender.id) + ") ha effettuato un acquisto.\n\nüõç Prodotto: " + stato[0] + "\nüí≥ Prezzo: -" + stato[2].replace(".", ",") + " EUR\nüïê Data & ora: " + dataora)
                    
                    while i < admins_num - 1:
                        i = i + 1
                        await client.send_message(int(admins[i]), "üõí ACQUISTO üõí\n\nüë§ L'utente <a href='tg://user?id=" + str(sender.id) + "'>" + sender.first_name + "</a> (" + str(sender.id) + ") ha effettuato un acquisto.\n\nüõç Prodotto: " + stato[0] + "\nüí≥ Prezzo: -" + stato[2].replace(".", ",") + " EUR\nüïê Data & ora: " + dataora)
    
    ####################################
    
    
    
    
    

client.run_until_disconnected()